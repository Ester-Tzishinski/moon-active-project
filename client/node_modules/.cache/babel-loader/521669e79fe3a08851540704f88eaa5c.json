{"ast":null,"code":"var _jsxFileName = \"C:\\\\project\\\\client\\\\src\\\\scroll.js\";\nimport React, { Component } from \"react\";\nimport InfiniteScroll from \"react-infinite-scroller\";\nimport { Button, ButtonGroup, Container, Table } from 'reactstrap';\nimport { Link } from 'react-router-dom';\nimport AppNavbar from './AppNavbar';\n\nclass Scroll2 extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      promotions: [],\n      items: 20,\n      hasMoreItems: true,\n      index: 0\n    };\n  }\n\n  componentDidMount() {\n    this.setState({\n      isLoading: true\n    });\n    fetch('api/schema').then(response => response.json()).then(schema => this.setState({\n      promotionCoulmn: schema,\n      isLoading: false\n    })); // fetch('api/promotions')\n    //     .then(response => response.json())\n    //     .then(data => this.setState({ promotions: data, isLoading: false }));\n\n    this.fetchItems();\n  }\n\n  async duplicate(item) {\n    await fetch(`/api/promotion/duplicate`, {\n      method: 'POST',\n      body: JSON.stringify(item),\n      headers: {\n        'Accept': 'application/json',\n        'Content-Type': 'application/json'\n      }\n    }).then(() => {\n      console.log(\"DUPLICATE Done!\");\n    });\n  }\n\n  async remove(id) {\n    await fetch(`/api/promotion/${id}`, {\n      method: 'DELETE',\n      headers: {\n        'Accept': 'application/json',\n        'Content-Type': 'application/json'\n      }\n    }).then(() => {\n      console.log(\"Remove Done!\");\n      let updatedPromotions = [...this.state.promotions].filter(i => i._id !== id);\n      this.setState({\n        promotions: updatedPromotions\n      });\n    });\n  }\n\n  fetchItems() {\n    // const length = this.state.length;\n    const index = this.state.index;\n    console.log(\"index\", index);\n    fetch(`api/promotions/${index}`).then(response => {\n      // debugger;\n      return response.json();\n    }).then(data => {\n      console.log('======data', data);\n      return this.setState({\n        promotions: data,\n        isLoading: false\n      });\n    }).catch(err => console.log('============e', err));\n    const {\n      promotions\n    } = this.state;\n    console.log(\"didMount\", promotions);\n  }\n\n  loadMore(page) {\n    console.log('=========loading', page); // debugger;\n\n    if (document.documentElement.scrollTop === document.documentElement.offsetHeight) {\n      this.setState({\n        hasMoreItems: false\n      });\n    } else {\n      if (this.state.index < 500) {\n        setTimeout(() => {\n          // this.setState({ length: this.state.length + 10 });\n          this.setState({\n            index: this.state.index + 10\n          });\n          this.fetchItems();\n          const {\n            promotions\n          } = this.state;\n          console.log(\"loadMore\", promotions);\n        }, 3000);\n      }\n    }\n  }\n\n  showItems() {\n    const items = []; // this.getPromotions();\n\n    const {\n      promotions,\n      index\n    } = this.state; // console.log(\"promotionsInShowItems\", promotions);\n    // for (var i = 0; i < this.state.length; i++) {\n    // items.push(<li key={i}> Item {i} </li>);\n\n    promotions.map(item => items.push( /*#__PURE__*/React.createElement(\"tr\", {\n      key: item._id,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 17\n      }\n    }, Object.values(item).map(value => /*#__PURE__*/React.createElement(\"td\", {\n      key: value,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 25\n      }\n    }, item._id != value ? value : '')), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(ButtonGroup, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      size: \"sm\",\n      color: \"primary\",\n      tag: Link,\n      to: \"/promotions/\" + item._id,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 29\n      }\n    }, \"Edit\"), /*#__PURE__*/React.createElement(Button, {\n      size: \"sm\",\n      color: \"\",\n      onClick: () => this.duplicate(item._id),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 29\n      }\n    }, \"Duplicate\"), /*#__PURE__*/React.createElement(Button, {\n      size: \"sm\",\n      color: \"danger\",\n      onClick: () => this.remove(item._id),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 29\n      }\n    }, \"Delete\")))))); // console.log(i);\n    // }\n\n    console.log('============items', items);\n    return items;\n  }\n\n  render() {\n    const {\n      promotionCoulmn,\n      promotions,\n      isLoading\n    } = this.state;\n\n    if (isLoading) {\n      return /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 20\n        }\n      }, \"Loading...\");\n    }\n\n    console.log(\"promotionCoulmn\", promotionCoulmn);\n    console.log(\"promotionsScroll\", promotions);\n    const keys = [];\n    const columns = [];\n    const k = [];\n    promotions.map(item => (k.push(Object.keys(item)), console.log(\"items\", k)));\n    k.map(item => (console.log(item), item.map(a => {\n      if (!columns.some(val => val === a)) {\n        columns.push(a);\n        console.log(\"em\", a);\n      }\n    })));\n    console.log(\"promotionC\", columns);\n    const p = columns.map(coulmn => /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 13\n      }\n    }, '_id' != coulmn ? coulmn : ''));\n    console.log(\"p\", columns);\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(AppNavbar, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(Container, {\n      fluid: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"float-right\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      color: \"success\",\n      tag: Link,\n      to: \"/promotions/new\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 25\n      }\n    }, \"Add Promotion\")), /*#__PURE__*/React.createElement(\"h3\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 21\n      }\n    }, \"Promotion List\"), /*#__PURE__*/React.createElement(Table, {\n      className: \"mt-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"thead\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 29\n      }\n    }, columns)), /*#__PURE__*/React.createElement(\"tbody\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        height: '500px',\n        overflow: 'auto'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(InfiniteScroll // isReverse\n    , {\n      loadMore: this.loadMore.bind(this),\n      hasMore: this.state.hasMoreItems,\n      loader: /*#__PURE__*/React.createElement(\"div\", {\n        className: \"loader\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156,\n          columnNumber: 45\n        }\n      }, \" Loading... \"),\n      useWindow: false,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152,\n        columnNumber: 33\n      }\n    }, this.showItems(), \" \"), \" \"), \" \")))); // return (\n    //     <div className=\"App\">\n    //         <div style={{ height: '600px', overflow: 'auto' }}>\n    //             <InfiniteScroll\n    //                 // isReverse\n    //                 loadMore={this.loadMore.bind(this)}\n    //                 hasMore={this.state.hasMoreItems}\n    //                 loader={<div className=\"loader\"> Loading... </div>}\n    //                 useWindow={false}>\n    //                 {this.showItems()}{\" \"}\n    //             </InfiniteScroll>{\" \"}\n    //         </div>{\" \"}\n    //     </div>\n    // );\n  }\n\n}\n\nexport default Scroll2;","map":{"version":3,"sources":["C:/project/client/src/scroll.js"],"names":["React","Component","InfiniteScroll","Button","ButtonGroup","Container","Table","Link","AppNavbar","Scroll2","constructor","props","state","promotions","items","hasMoreItems","index","componentDidMount","setState","isLoading","fetch","then","response","json","schema","promotionCoulmn","fetchItems","duplicate","item","method","body","JSON","stringify","headers","console","log","remove","id","updatedPromotions","filter","i","_id","data","catch","err","loadMore","page","document","documentElement","scrollTop","offsetHeight","setTimeout","showItems","map","push","Object","values","value","render","keys","columns","k","a","some","val","p","coulmn","height","overflow","bind"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport InfiniteScroll from \"react-infinite-scroller\";\r\nimport { Button, ButtonGroup, Container, Table } from 'reactstrap';\r\nimport { Link } from 'react-router-dom';\r\nimport AppNavbar from './AppNavbar';\r\nclass Scroll2 extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = { promotions: [], items: 20, hasMoreItems: true, index: 0 };\r\n    }\r\n    componentDidMount() {\r\n        this.setState({ isLoading: true });\r\n        fetch('api/schema')\r\n            .then(response => response.json())\r\n            .then(schema => this.setState({ promotionCoulmn: schema, isLoading: false }));\r\n        // fetch('api/promotions')\r\n        //     .then(response => response.json())\r\n        //     .then(data => this.setState({ promotions: data, isLoading: false }));\r\n        this.fetchItems();\r\n    }\r\n    async duplicate(item) {\r\n        await fetch(`/api/promotion/duplicate`, {\r\n            method: 'POST',\r\n            body: JSON.stringify(item),\r\n            headers: {\r\n                'Accept': 'application/json',\r\n                'Content-Type': 'application/json'\r\n            }\r\n        }).then(() => {\r\n            console.log(\"DUPLICATE Done!\");\r\n        });\r\n    }\r\n    async remove(id) {\r\n        await fetch(`/api/promotion/${id}`, {\r\n            method: 'DELETE',\r\n            headers: {\r\n                'Accept': 'application/json',\r\n                'Content-Type': 'application/json'\r\n            }\r\n        }).then(() => {\r\n            console.log(\"Remove Done!\");\r\n            let updatedPromotions = [...this.state.promotions].filter(i => i._id !== id);\r\n            this.setState({ promotions: updatedPromotions });\r\n        });\r\n    }\r\n    fetchItems() {\r\n        // const length = this.state.length;\r\n        const index = this.state.index;\r\n        console.log(\"index\", index);\r\n        fetch(`api/promotions/${index}`)\r\n            .then(response => {\r\n                // debugger;\r\n                return response.json()\r\n            })\r\n            .then(data => {\r\n                console.log('======data', data);\r\n                return this.setState({ promotions: data, isLoading: false })\r\n            }\r\n            )\r\n            .catch(err => console.log('============e', err));\r\n        const { promotions } = this.state;\r\n        console.log(\"didMount\", promotions);\r\n    }\r\n    loadMore(page) {\r\n        console.log('=========loading', page);\r\n        // debugger;\r\n        if (document.documentElement.scrollTop === document.documentElement.offsetHeight) {\r\n            this.setState({ hasMoreItems: false });\r\n        } else {\r\n            if (this.state.index < 500) {\r\n                setTimeout(() => {\r\n                    // this.setState({ length: this.state.length + 10 });\r\n                    this.setState({ index: this.state.index + 10 });\r\n                    this.fetchItems()\r\n                    const { promotions } = this.state;\r\n                    console.log(\"loadMore\", promotions);\r\n                }, 3000);\r\n            }\r\n        }\r\n    }\r\n    showItems() {\r\n        const items = [];\r\n        // this.getPromotions();\r\n        const { promotions, index } = this.state;\r\n        // console.log(\"promotionsInShowItems\", promotions);\r\n        // for (var i = 0; i < this.state.length; i++) {\r\n        // items.push(<li key={i}> Item {i} </li>);\r\n        promotions.map(item => (\r\n            items.push(\r\n                <tr key={item._id}>{\r\n                    Object.values(item).map(value =>\r\n                        <td key={value}>{item._id != value ? value : ''}</td>\r\n                    )}<td>\r\n                        <ButtonGroup>\r\n                            <Button size=\"sm\" color=\"primary\" tag={Link} to={\"/promotions/\" + item._id}>Edit</Button>\r\n                            <Button size=\"sm\" color=\"\" onClick={() => this.duplicate(item._id)}>Duplicate</Button>\r\n                            <Button size=\"sm\" color=\"danger\" onClick={() => this.remove(item._id)}>Delete</Button>\r\n                        </ButtonGroup>\r\n                    </td>\r\n                </tr>\r\n            )\r\n        ))\r\n        // console.log(i);\r\n        // }\r\n        console.log('============items', items);\r\n        return items;\r\n    }\r\n    render() {\r\n        const { promotionCoulmn, promotions, isLoading } = this.state;\r\n        if (isLoading) {\r\n            return <p>Loading...</p>;\r\n        }\r\n        console.log(\"promotionCoulmn\", promotionCoulmn);\r\n        console.log(\"promotionsScroll\", promotions);\r\n        const keys=[];\r\n        const columns = [];\r\n        const k = [];\r\n        promotions.map(item => (\r\n            k.push(Object.keys(item)),\r\n            console.log(\"items\", k)\r\n        )\r\n        )\r\n        k.map((item) => (\r\n            console.log(item),\r\n            item.map(a => {\r\n                if (!columns.some(val => val === a)) {\r\n                    columns.push(a);\r\n                    console.log(\"em\", a);\r\n                }\r\n            })\r\n        )\r\n        )\r\n        console.log(\"promotionC\", columns);\r\n        const p = columns.map(coulmn =>\r\n            <th>{'_id' != coulmn ? coulmn : ''}</th>\r\n        )\r\n        console.log(\"p\", columns);\r\n        return (\r\n            <div>\r\n                <AppNavbar />\r\n                <Container fluid>\r\n                    <div className=\"float-right\">\r\n                        <Button color=\"success\" tag={Link} to=\"/promotions/new\">Add Promotion</Button>\r\n                    </div>\r\n                    <h3>Promotion List</h3>\r\n                    <Table className=\"mt-4\">\r\n                        <thead>\r\n                            <th>{columns}</th>\r\n                        </thead>\r\n                        <tbody>\r\n                            <div style={{ height: '500px', overflow: 'auto' }}>\r\n                                <InfiniteScroll\r\n                                    // isReverse\r\n                                    loadMore={this.loadMore.bind(this)}\r\n                                    hasMore={this.state.hasMoreItems}\r\n                                    loader={<div className=\"loader\"> Loading... </div>}\r\n                                    useWindow={false}>\r\n                                    {this.showItems()}{\" \"}\r\n                                </InfiniteScroll>{\" \"}\r\n                            </div>{\" \"}\r\n                        </tbody>\r\n                    </Table>\r\n                </Container>\r\n            </div>\r\n        );\r\n        // return (\r\n        //     <div className=\"App\">\r\n        //         <div style={{ height: '600px', overflow: 'auto' }}>\r\n        //             <InfiniteScroll\r\n        //                 // isReverse\r\n        //                 loadMore={this.loadMore.bind(this)}\r\n        //                 hasMore={this.state.hasMoreItems}\r\n        //                 loader={<div className=\"loader\"> Loading... </div>}\r\n        //                 useWindow={false}>\r\n        //                 {this.showItems()}{\" \"}\r\n        //             </InfiniteScroll>{\" \"}\r\n        //         </div>{\" \"}\r\n        //     </div>\r\n        // );\r\n    }\r\n}\r\n\r\nexport default Scroll2;"]},"metadata":{},"sourceType":"module"}