{"ast":null,"code":"var _jsxFileName = \"C:\\\\project\\\\client\\\\src\\\\PromotionList.js\";\nimport React, { Component } from \"react\";\nimport InfiniteScroll from \"react-infinite-scroller\";\nimport { Button, ButtonGroup, Container, Table } from 'reactstrap';\nimport { Link } from 'react-router-dom';\nimport AppNavbar from './AppNavbar';\n\nclass Scroll2 extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      promotions: [],\n      items: 20,\n      hasMoreItems: true,\n      index: 0\n    };\n  }\n\n  componentDidMount() {\n    this.setState({\n      isLoading: true\n    });\n    fetch('api/schema').then(response => response.json()).then(schema => this.setState({\n      promotionCoulmn: schema,\n      isLoading: false\n    })); // fetch('api/promotions')\n    //     .then(response => response.json())\n    //     .then(data => this.setState({ promotions: data, isLoading: false }));\n\n    this.fetchItems();\n  }\n\n  async duplicate(item) {\n    await fetch(`/api/promotion/duplicate`, {\n      method: 'POST',\n      body: JSON.stringify(item),\n      headers: {\n        'Accept': 'application/json',\n        'Content-Type': 'application/json'\n      }\n    }).then(() => {\n      console.log(\"DUPLICATE Done!\");\n    });\n  }\n\n  async remove(id) {\n    await fetch(`/api/promotion/${id}`, {\n      method: 'DELETE',\n      headers: {\n        'Accept': 'application/json',\n        'Content-Type': 'application/json'\n      }\n    }).then(() => {\n      console.log(\"Remove Done!\");\n      let updatedPromotions = [...this.state.promotions].filter(i => i._id !== id);\n      this.setState({\n        promotions: updatedPromotions\n      });\n    });\n  }\n\n  fetchItems() {\n    // const length = this.state.length;\n    const index = this.state.index;\n    console.log(\"index\", index);\n    fetch(`api/promotions/${index}`).then(response => {\n      // debugger;\n      return response.json();\n    }).then(data => {\n      console.log('======data', data);\n      return this.setState({\n        promotions: data,\n        isLoading: false\n      });\n    }).catch(err => console.log('============e', err));\n    const {\n      promotions\n    } = this.state;\n    console.log(\"didMount\", promotions);\n  }\n\n  loadMore(page) {\n    console.log('=========loading', page); // debugger;\n\n    if (document.documentElement.scrollTop === document.documentElement.offsetHeight) {\n      this.setState({\n        hasMoreItems: false\n      });\n    } else {\n      if (this.state.index < 500) {\n        setTimeout(() => {\n          // this.setState({ length: this.state.length + 10 });\n          this.setState({\n            index: this.state.index + 10\n          });\n          this.fetchItems();\n          const {\n            promotions\n          } = this.state;\n          console.log(\"loadMore\", promotions);\n        }, 3000);\n      }\n    }\n  }\n\n  showItems() {\n    const items = []; // this.getPromotions();\n\n    const {\n      promotions,\n      index\n    } = this.state; // console.log(\"promotionsInShowItems\", promotions);\n    // for (var i = 0; i < this.state.length; i++) {\n    // items.push(<li key={i}> Item {i} </li>);\n\n    promotions.map(item => items.push( /*#__PURE__*/React.createElement(\"tr\", {\n      key: item._id,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 9\n      }\n    }, Object.values(item).map(value => /*#__PURE__*/React.createElement(\"td\", {\n      key: value,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 13\n      }\n    }, item._id != value ? value : '')), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(ButtonGroup, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      size: \"sm\",\n      color: \"primary\",\n      tag: Link,\n      to: \"/promotions/\" + item._id,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 15\n      }\n    }, \"Edit\"), /*#__PURE__*/React.createElement(Button, {\n      size: \"sm\",\n      color: \"\",\n      onClick: () => this.duplicate(item._id),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 15\n      }\n    }, \"Duplicate\"), /*#__PURE__*/React.createElement(Button, {\n      size: \"sm\",\n      color: \"danger\",\n      onClick: () => this.remove(item._id),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 15\n      }\n    }, \"Delete\")))))); // console.log(i);\n    // }\n\n    console.log('============items', items);\n    return items;\n  }\n\n  render() {\n    const {\n      promotionCoulmn,\n      promotions,\n      isLoading\n    } = this.state;\n\n    if (isLoading) {\n      return /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 14\n        }\n      }, \"Loading...\");\n    }\n\n    console.log(\"promotionCoulmn\", promotionCoulmn);\n    console.log(\"promotionsScroll\", promotions);\n    const keys = [];\n    const columns = [];\n    promotions.map(item => keys.push(Object.keys(item)));\n    keys.map(item => item.map(a => {\n      if (!columns.some(val => val === a)) {\n        columns.push(a);\n      }\n    }));\n    const col = columns.map(coulmn => /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 7\n      }\n    }, '_id' != coulmn ? coulmn : ''));\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(AppNavbar, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(Container, {\n      fluid: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"float-right\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      color: \"success\",\n      tag: Link,\n      to: \"/promotions/new\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 13\n      }\n    }, \"Add Promotion\")), /*#__PURE__*/React.createElement(\"h3\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 11\n      }\n    }, \"Promotion List\"), /*#__PURE__*/React.createElement(Table, {\n      className: \"mt-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"thead\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 15\n      }\n    }, col)), /*#__PURE__*/React.createElement(\"tbody\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        height: '500px',\n        overflow: 'auto',\n        width: '1000'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(InfiniteScroll // isReverse\n    , {\n      loadMore: this.loadMore.bind(this),\n      hasMore: this.state.hasMoreItems,\n      loader: /*#__PURE__*/React.createElement(\"div\", {\n        className: \"loader\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 27\n        }\n      }, \" Loading... \"),\n      useWindow: false,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 17\n      }\n    }, this.showItems(), \" \"), \" \"), \" \"))));\n  }\n\n}\n\nexport default Scroll2;","map":{"version":3,"sources":["C:/project/client/src/PromotionList.js"],"names":["React","Component","InfiniteScroll","Button","ButtonGroup","Container","Table","Link","AppNavbar","Scroll2","constructor","props","state","promotions","items","hasMoreItems","index","componentDidMount","setState","isLoading","fetch","then","response","json","schema","promotionCoulmn","fetchItems","duplicate","item","method","body","JSON","stringify","headers","console","log","remove","id","updatedPromotions","filter","i","_id","data","catch","err","loadMore","page","document","documentElement","scrollTop","offsetHeight","setTimeout","showItems","map","push","Object","values","value","render","keys","columns","a","some","val","col","coulmn","height","overflow","width","bind"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport InfiniteScroll from \"react-infinite-scroller\";\r\nimport { Button, ButtonGroup, Container, Table } from 'reactstrap';\r\nimport { Link } from 'react-router-dom';\r\nimport AppNavbar from './AppNavbar';\r\nclass Scroll2 extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = { promotions: [], items: 20, hasMoreItems: true, index: 0 };\r\n  }\r\n  componentDidMount() {\r\n    this.setState({ isLoading: true });\r\n    fetch('api/schema')\r\n      .then(response => response.json())\r\n      .then(schema => this.setState({ promotionCoulmn: schema, isLoading: false }));\r\n    // fetch('api/promotions')\r\n    //     .then(response => response.json())\r\n    //     .then(data => this.setState({ promotions: data, isLoading: false }));\r\n    this.fetchItems();\r\n  }\r\n  async duplicate(item) {\r\n    await fetch(`/api/promotion/duplicate`, {\r\n      method: 'POST',\r\n      body: JSON.stringify(item),\r\n      headers: {\r\n        'Accept': 'application/json',\r\n        'Content-Type': 'application/json'\r\n      }\r\n    }).then(() => {\r\n      console.log(\"DUPLICATE Done!\");\r\n    });\r\n  }\r\n  async remove(id) {\r\n    await fetch(`/api/promotion/${id}`, {\r\n      method: 'DELETE',\r\n      headers: {\r\n        'Accept': 'application/json',\r\n        'Content-Type': 'application/json'\r\n      }\r\n    }).then(() => {\r\n      console.log(\"Remove Done!\");\r\n      let updatedPromotions = [...this.state.promotions].filter(i => i._id !== id);\r\n      this.setState({ promotions: updatedPromotions });\r\n    });\r\n  }\r\n  fetchItems() {\r\n    // const length = this.state.length;\r\n    const index = this.state.index;\r\n    console.log(\"index\", index);\r\n    fetch(`api/promotions/${index}`)\r\n      .then(response => {\r\n        // debugger;\r\n        return response.json()\r\n      })\r\n      .then(data => {\r\n        console.log('======data', data);\r\n        return this.setState({ promotions: data, isLoading: false })\r\n      }\r\n      )\r\n      .catch(err => console.log('============e', err));\r\n    const { promotions } = this.state;\r\n    console.log(\"didMount\", promotions);\r\n  }\r\n  loadMore(page) {\r\n    console.log('=========loading', page);\r\n    // debugger;\r\n    if (document.documentElement.scrollTop === document.documentElement.offsetHeight) {\r\n      this.setState({ hasMoreItems: false });\r\n    } else {\r\n      if (this.state.index < 500) {\r\n        setTimeout(() => {\r\n          // this.setState({ length: this.state.length + 10 });\r\n          this.setState({ index: this.state.index + 10 });\r\n          this.fetchItems()\r\n          const { promotions } = this.state;\r\n          console.log(\"loadMore\", promotions);\r\n        }, 3000);\r\n      }\r\n    }\r\n  }\r\n  showItems() {\r\n    const items = [];\r\n    // this.getPromotions();\r\n    const { promotions, index } = this.state;\r\n    // console.log(\"promotionsInShowItems\", promotions);\r\n    // for (var i = 0; i < this.state.length; i++) {\r\n    // items.push(<li key={i}> Item {i} </li>);\r\n    promotions.map(item => (\r\n      items.push(\r\n        <tr key={item._id}>{\r\n          Object.values(item).map(value =>\r\n            <td key={value}>{item._id != value ? value : ''}</td>\r\n          )}<td>\r\n            <ButtonGroup>\r\n              <Button size=\"sm\" color=\"primary\" tag={Link} to={\"/promotions/\" + item._id}>Edit</Button>\r\n              <Button size=\"sm\" color=\"\" onClick={() => this.duplicate(item._id)}>Duplicate</Button>\r\n              <Button size=\"sm\" color=\"danger\" onClick={() => this.remove(item._id)}>Delete</Button>\r\n            </ButtonGroup>\r\n          </td>\r\n        </tr>\r\n      )\r\n    ))\r\n    // console.log(i);\r\n    // }\r\n    console.log('============items', items);\r\n    return items;\r\n  }\r\n  render() {\r\n    const { promotionCoulmn, promotions, isLoading } = this.state;\r\n    if (isLoading) {\r\n      return <p>Loading...</p>;\r\n    }\r\n    console.log(\"promotionCoulmn\", promotionCoulmn);\r\n    console.log(\"promotionsScroll\", promotions);\r\n    const keys = [];\r\n    const columns = [];\r\n    promotions.map(item => (\r\n      keys.push(Object.keys(item))\r\n    ))\r\n    keys.map((item) => (\r\n      item.map(a => {\r\n        if (!columns.some(val => val === a)) {\r\n          columns.push(a);\r\n        }\r\n      })))\r\n    const col = columns.map(coulmn =>\r\n      <th>{'_id' != coulmn ? coulmn : ''}</th>\r\n    )\r\n    return (\r\n      <div>\r\n        <AppNavbar />\r\n        <Container fluid>\r\n          <div className=\"float-right\">\r\n            <Button color=\"success\" tag={Link} to=\"/promotions/new\">Add Promotion</Button>\r\n          </div>\r\n          <h3>Promotion List</h3>\r\n          <Table className=\"mt-4\">\r\n            <thead>\r\n              <tr>{col}</tr>\r\n            </thead>\r\n            <tbody>\r\n              <div style={{ height: '500px', overflow: 'auto' ,width:'1000'}}>\r\n                <InfiniteScroll\r\n                  // isReverse\r\n                  loadMore={this.loadMore.bind(this)}\r\n                  hasMore={this.state.hasMoreItems}\r\n                  loader={<div className=\"loader\"> Loading... </div>}\r\n                  useWindow={false}>\r\n                  {this.showItems()}{\" \"}\r\n                </InfiniteScroll>{\" \"}\r\n              </div>{\" \"}\r\n            </tbody>\r\n          </Table>\r\n        </Container>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Scroll2;"]},"metadata":{},"sourceType":"module"}